// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-array@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-copy@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-accessor@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-positive-integer@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-pow@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-max@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-number@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-positive-number@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@esm/index.mjs";var u=n,f=a,v=i,g=t,b=o,j=function(e,t){var r,s=e.length,i=0;for(r=0;r<s;r++)i+=e[r]*t[r];return i};function w(e,t){var r;if(!(this instanceof w))return new w(e,t);if(!u(e))throw new TypeError(g("0LT5I",e));if(!f(t))throw new TypeError(g("0LT5J",t));for(this.scale=1,this.norm=0,this.intercept=t,this.nWeights=e+(this.intercept?1:0),this._data=new Array(this.nWeights),r=0;r<this.nWeights;r++)this._data[r]=0}v(w.prototype,"scaleTo",(function(e){var t;if(this.scale<1e-11){for(t=0;t<this.nWeights;t++)this._data[t]*=this.scale;this.scale=1}if(this.norm*=b(e,2),!(e>0))throw new RangeError(g("0LT5H",e));this.scale*=e})),v(w.prototype,"add",(function(e,t){var r,s,i;for(s=0,void 0===t&&(t=1),i=0;i<e.length;i++)r=e[i]*t,s+=this._data[i]*r,this._data[i]=this._data[i]+r/this.scale;this.intercept&&(r=1*t,s+=this._data[i]*r,this._data[i]=this._data[i]+r/this.scale),this.norm+=(j(e,e)+(this.intercept?1:0))*b(t,2)+2*this.scale*s})),v(w.prototype,"innerProduct",(function(e){var t,r=0;for(t=0;t<e.length;t++)r+=this._data[t]*e[t];return r+=this.intercept?this._data[t]:0,r*=this.scale}));var T=w,y=l;var x=function(e,t,r){var s;t>0&&(s=1-r*t,e.scaleTo(y(s,1e-7)))},E=x;var L=function(e,t,r,s,i,n){var a=e.innerProduct(t)-r;E(e,i,s),a>n?e.add(t,-s):a<-n&&e.add(t,+s)},_=x;var P=function(e,t,r,s,i){var n=r-e.innerProduct(t);_(e,i,s),e.add(t,s*n)},R=x;var W=function(e,t,r,s,i,n){var a=e.innerProduct(t)-r;R(e,i,s),a>n?e.add(t,-s):a<-n?e.add(t,+s):e.add(t,-s*a)},k=t;var q=function(e,t,r){var s,i;switch(s=1,e){case"basic":i=function(){var e=1e3/(s+1e3);return s+=1,e};break;case"constant":i=function(){return s+=1,t};break;case"pegasos":i=function(){var e=1/(r*s);return s+=1,e};break;default:throw new Error(k("0LT5E",e))}return i},I={epsilon:.1,eta0:.02,intercept:!0,lambda:.001,learningRate:"basic",loss:"squaredError"},V=d.isPrimitive,A=h.isPrimitive,F=a.isPrimitive,Q=p,G=m.isPrimitive,H=c,J=t;var z=e,B=t,C=r,D=s,K=i,M=T,N=L,O=P,S=W,U=q,X=I,Y=function(e,t){return Q(t)?H(t,"epsilon")&&(e.epsilon=t.epsilon,!A(e.epsilon))?new TypeError(J("0LT4Q","epsilon",e.epsilon)):H(t,"eta0")&&(e.eta0=t.eta0,!A(e.eta0))?new TypeError(J("0LT4Q","eta0",e.eta0)):H(t,"lambda")&&(e.lambda=t.lambda,!V(e.lambda))?new TypeError(J("0LT4x","lambda",e.lambda)):H(t,"learningRate")&&(e.learningRate=t.learningRate,!G(e.learningRate))?new TypeError(J("0LT2i","learningRate",e.learningRate)):H(t,"loss")&&(e.loss=t.loss,!G(e.loss))?new TypeError(J("0LT2i","loss",e.loss)):H(t,"intercept")&&(e.intercept=t.intercept,!F(e.intercept))?new TypeError(J("0LT30","intercept",e.intercept)):null:new TypeError(J("0LT2h",t))};var Z=function(e){var t,r,s,i,n,a,o;if(a=C(X),arguments.length>0&&(o=Y(a,e)))throw o;switch(s=null,a.loss){case"epsilonInsensitive":r=N;break;case"huber":r=S;break;case"squaredError":r=O;break;default:throw Error(B("invalid input value. `loss` option must be either `epsilonInsensitive`, `huber` or `squaredError`. Value: `%s`.",a.loss))}function n(e,n){var o;if(!z(e))throw new TypeError(B("invalid input value. First argument `x` must be an array. Value: `%s`.",e));if(s||(s=new M(e.length,a.intercept),t=a.intercept?s.nWeights-1:s.nWeights),e.length!==t)throw new TypeError(B("invalid input value. First argument `x` must be an array of length `%u`. Value: `%s`",t,e));o=i(),r(s,e,n,o,a.lambda,a.epsilon)}return i=U(a.learningRate,a.eta0,a.lambda),D(n,"coefs",l),K(n,"predict",d),n;function l(){var e,t;for(e=new Array(s.nWeights),t=0;t<e.length;t++)e[t]=s._data[t]*s.scale;return e}function d(e){if(!z(e)||e.length!==t)throw new TypeError(B("0LT5G",t||0,e));return s.innerProduct(e)}};export{Z as default};
//# sourceMappingURL=index.mjs.map
